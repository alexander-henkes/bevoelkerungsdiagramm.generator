<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="author" content="Alexander Henkes, geographie-im-unterricht.de">
    <meta name="description" content="population charts generator, written in HTML and JS">
    <meta name="keywords" content="geography, Geographie, population charts, demography, Bevölkerungsdiagramme, Demographie">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      
    <!--Deutsch: Der Autor dieses Projekts ist Alexander Henkes. Alle Rechte am Code vorbehalten. Dieser darf ausschließlich unter geographie-im-unterricht.de und dem entsprechenden  GitHub repository "alexander-henkes/bevoelkerungsdiagramm.generator" aufgeführt werden. Es kommt chart.js zur Anwendung: https://github.com/chartjs/Chart.js
    Die mithilfe der Applikation erzeugten Bevölkerungsdiagramme sind lizensiert unter der Creative Commons Namensnennung - Nicht-kommerziell - Weitergabe unter gleichen Bedingungen 4.0 International (CC BY-NC-SA 4.0) Lizenz. Bitte beachten Sie zwecks Weiterverwendung die dargestellten Lizenzbedingungen: https://creativecommons.org/licenses/by-nc-sa/4.0/deed.de-->
      
    <!--English: The author of this project is Alexander Henkes. All rights to the code reserved. This may only be visible under geographie-im-unterricht.de and the corresponding GitHub repository "alexander-henkes/bevoelkerungsdiagramm.generator". chart.js is used: https://github.com/chartjs/Chart.js
    The generated population charts using the application are licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) License. For further use, please note the license conditions shown: https://creativecommons.org/licenses/by-nc-sa/4.0/-->
      
<title>Bevölkerungsdiagramm-Generator</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        font-family: 'Roboto';
      }
      .chartMenu {
        width: 1.2);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .chartBox {
        width: 500px;
        padding: 20px;
        border-radius: 20px;
        background: white;
      }
    </style>
  </head>

<body>
<h2 align = "left">Allgemeine Informationen</h2><br>
<table class="table">
    <tr>
      <th align = "right">Land/Stadt:&nbsp;</th>
      <td><input type="string" class="information" id="place" placeholder=" Deutschland"/></td>
    </tr>
    <tr>
      <th align = "right">Jahr:&nbsp;</th>
      <td><input type="" class="information" id="year" placeholder=" 2020"/></td>
    </tr>
    <tr>
    <th align = "right">Einwohner&nbsp;(total):&nbsp;</th>
      <td><input type="" class="information" id="population" placeholder=" Gesamteinwohnerzahl"/></td>
    </tr>
    <tr>
    <th align = "right">Einheit:&nbsp;</th>
      <td><input type="" class="information" id="unit" placeholder=" bspw. % oder Mio."/></td>
    </tr>
</table>
<br><br>
<h2 align = "left">Männer</h2><br>
<table class="table">
  <tbody>
    <tr>
      <th align = "right">≤ 5:&nbsp;</th>
      <td><input type="number" class="male" id="male1" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">6–10:&nbsp;</th>
      <td><input type="number" class="male" id="male2" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">11–15:&nbsp;</th>
      <td><input type="number" class="male" id="male3" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">16–20:&nbsp;</th>
      <td><input type="number" class="male" id="male4" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">21–25:&nbsp;</th>
      <td><input type="number" class="male" id="male5" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">26–30:&nbsp;</th>
      <td><input type="number" class="male" id="male6" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">31–35:&nbsp;</th>
      <td><input type="number" class="male" id="male7" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">36–40:&nbsp;</th>
      <td><input type="number" class="male" id="male8" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">41–45:&nbsp;</th>
      <td><input type="number" class="male" id="male9" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">46–50:&nbsp;</th>
      <td><input type="number" class="male" id="male10" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">51–55:&nbsp;</th>
      <td><input type="number" class="male" id="male11" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">56–60:&nbsp;</th>
      <td><input type="number" class="male" id="male12" placeholder="beliebige Einheit"/></td>
    </tr>
     <tr>
      <th align = "right">61–65:&nbsp;</th>
      <td><input type="number" class="male" id="male13" placeholder="beliebige Einheit"/></td>
    </tr>     
     <tr>
      <th align = "right">66–70:&nbsp;</th>
      <td><input type="number" class="male" id="male14" placeholder="beliebige Einheit"/></td>
    </tr>     
     <tr>
      <th align = "right">71–75:&nbsp;</th>
      <td><input type="number" class="male" id="male15" placeholder="beliebige Einheit"/></td>
    </tr>     
    <tr>
      <th align = "right">76–80:&nbsp;</th>
      <td><input type="number" class="male" id="male16" placeholder="beliebige Einheit"/></td>
    </tr>      
    <tr>
      <th align = "right">81–85:&nbsp;</th>
      <td><input type="number" class="male" id="male17" placeholder="beliebige Einheit"/></td>
    </tr>      
     <tr>
      <th align = "right">86–90:&nbsp;</th>
      <td><input type="number" class="male" id="male18" placeholder="beliebige Einheit"/></td>
    </tr>    
     <tr>
      <th align = "right">91–95:&nbsp;</th>
      <td><input type="number" class="male" id="male19" placeholder="beliebige Einheit"/></td>
    </tr>           
     <tr>
      <th align = "right">≥ 96:&nbsp;</th>
      <td><input type="number" class="male" id="male20" placeholder="beliebige Einheit"/></td>
    </tr>           
      
  </tbody>
</table>
<br><br>
<h2 align = "left">Frauen</h2><br>
<table class="table">
  <tbody>
    <tr>
      <th align = "right">≤ 5:&nbsp;</th>
      <td><input type="number" class="female" id="female1" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">6–10:&nbsp;</th>
      <td><input type="number" class="female" id="female2" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">11–15:&nbsp;</th>
      <td><input type="number" class="female" id="female3" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">16–20:&nbsp;</th>
      <td><input type="number" class="female" id="female4" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">21–25:&nbsp;</th>
      <td><input type="number" class="female" id="female5" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">26–30:&nbsp;</th>
      <td><input type="number" class="female" id="female6" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">31–35:&nbsp;</th>
      <td><input type="number" class="female" id="female7" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">36–40:&nbsp;</th>
      <td><input type="number" class="female" id="female8" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">41–45:&nbsp;</th>
      <td><input type="number" class="female" id="female9" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">46–50:&nbsp;</th>
      <td><input type="number" class="female" id="female10" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">51–55:&nbsp;</th>
      <td><input type="number" class="female" id="female11" placeholder="beliebige Einheit"/></td>
    </tr>
    <tr>
      <th align = "right">56–60:&nbsp;</th>
      <td><input type="number" class="female" id="female12" placeholder="beliebige Einheit"/></td>
    </tr>
     <tr>
      <th align = "right">61–65:&nbsp;</th>
      <td><input type="number" class="female" id="female13" placeholder="beliebige Einheit"/></td>
    </tr>     
     <tr>
      <th align = "right">66–70:&nbsp;</th>
      <td><input type="number" class="female" id="female14" placeholder="beliebige Einheit"/></td>
    </tr>     
     <tr>
      <th align = "right">71–75:&nbsp;</th>
      <td><input type="number" class="female" id="female15" placeholder="beliebige Einheit"/></td>
    </tr>     
    <tr>
      <th align = "right">76–80:&nbsp;</th>
      <td><input type="number" class="female" id="female16" placeholder="beliebige Einheit"/></td>
    </tr>      
    <tr>
      <th align = "right">81–85:&nbsp;</th>
      <td><input type="number" class="female" id="female17" placeholder="beliebige Einheit"/></td>
    </tr>      
     <tr>
      <th align = "right">86–90:&nbsp;</th>
      <td><input type="number" class="female" id="female18" placeholder="beliebige Einheit"/></td>
    </tr>    
     <tr>
      <th align = "right">91–95:&nbsp;</th>
      <td><input type="number" class="female" id="female19" placeholder="beliebige Einheit"/></td>
    </tr>           
     <tr>
      <th align = "right">≥ 96:&nbsp;</th>
      <td><input type="number" class="female" id="female20" placeholder="beliebige Einheit"/></td>
    </tr>     
  </tbody>
</table> 
<br>      
<output hidden id="highMale">0</output> 
<output hidden id="highFemale">0</output> 

<div class="chartBox">
  <canvas id="populationChart"></canvas>
</div>


<input align="left" id="create_populationChart()" type="button" value=" Bevölkerungsdiagramm erstellen " onclick="maxMale();maxFemale();create_populationChart()"/><br><br>
<input align="left" id="reload_populationChart(()" type="button" value=" Bevölkerungsdiagramm zurücksetzen " onclick="window.location.href=window.location.href"/><br><br> 
<input align="left" id="reload_populationChart()" type="button" value=" Herunterladen " onclick="download()"/><br>  

<script type="text/javascript" src="https://geographie-im-unterricht.de/files/chart.js/chart.js"></script>
    
 <script>
// max values for male & female
    function maxMale(){
            var arr = document.querySelectorAll(".male");
            var emptyarray = [];
            arr.forEach((elem) => {
                emptyarray.push(elem.value);
            })
            var max = Math.max.apply(null, emptyarray);
            document.getElementById("highMale").innerHTML=max;
    }
    function maxFemale(){
            var arr = document.querySelectorAll(".female");
            var emptyarray = [];
            arr.forEach((elem) => {
                emptyarray.push(elem.value);
            })
            var max = Math.max.apply(null, emptyarray);
            document.getElementById("highFemale").innerHTML=max;
    }
// now create population chart
function create_populationChart() {
// general information
  let place = document.getElementById("place").value;
   let year = document.getElementById("year").value;
  let population = document.getElementById("population").value;
   let unit = document.getElementById("unit").value; 
// values for man
  let male1 = document.getElementById("male1").value * -1;
   let male2 = document.getElementById("male2").value * -1;
  let male3 = document.getElementById("male3").value * -1;
   let male4 = document.getElementById("male4").value * -1;
  let male5 = document.getElementById("male5").value * -1;
   let male6 = document.getElementById("male6").value * -1;
  let male7 = document.getElementById("male7").value * -1;
   let male8 = document.getElementById("male8").value * -1;
  let male9 = document.getElementById("male9").value * -1;
   let male10 = document.getElementById("male10").value * -1;
  let male11 = document.getElementById("male11").value * -1;
   let male12 = document.getElementById("male12").value * -1;
  let male13 = document.getElementById("male13").value * -1;
   let male14 = document.getElementById("male14").value * -1;
  let male15 = document.getElementById("male15").value * -1;
   let male16 = document.getElementById("male16").value * -1;
  let male17 = document.getElementById("male17").value * -1;
   let male18 = document.getElementById("male18").value * -1;
  let male19 = document.getElementById("male19").value * -1;
   let male20 = document.getElementById("male20").value * -1;
// values for man
  let female1 = document.getElementById("female1").value;
   let female2 = document.getElementById("female2").value;
  let female3 = document.getElementById("female3").value;
   let female4 = document.getElementById("female4").value;
  let female5 = document.getElementById("female5").value;
   let female6 = document.getElementById("female6").value;
  let female7 = document.getElementById("female7").value;
   let female8 = document.getElementById("female8").value;
  let female9 = document.getElementById("female9").value;
   let female10 = document.getElementById("female10").value;
  let female11 = document.getElementById("female11").value;
   let female12 = document.getElementById("female12").value;
  let female13 = document.getElementById("female13").value;
   let female14 = document.getElementById("female14").value;
  let female15 = document.getElementById("female15").value;
   let female16 = document.getElementById("female16").value;
  let female17 = document.getElementById("female17").value;
   let female18 = document.getElementById("female18").value;
  let female19 = document.getElementById("female19").value;
   let female20 = document.getElementById("female20").value;
// set high
  let maxMale = document.getElementById("highMale").value;
   let maxFemale = document.getElementById("highFemale").value;
  let maxMaleRounded = Math.ceil(maxMale / 5) * 5;
    let maxFemaleRounded = Math.ceil(maxFemale / 5) * 5;
    
    if(maxMaleRounded > maxFemaleRounded) {
        maxFemaleRounded = maxMaleRounded;
    }
    if(maxFemaleRounded > maxMaleRounded) {
        maxMaleRounded = maxFemaleRounded;
    }

// add white background
var whitebackgroundColor = {
  beforeDraw: function(chart, args, options) {
    const ctx = chart.ctx;
    const canvas = chart.canvas;
    const chartArea = chart.chartArea;
    //
    var background = canvas.getContext("2d").createLinearGradient(0, 250, 0, 0);
    background.addColorStop(0, "white");
    ctx.fillStyle = background;
    ctx.fillRect(0, 700,
      600 - 0, 0 - 700);
  }
};
// add background color of chart only
var backgroundColor = {
  beforeDraw: function(chart, args, options) {
    const ctx = chart.ctx;
    const canvas = chart.canvas;
    const chartArea = chart.chartArea;
    //
    var background = canvas.getContext("2d").createLinearGradient(0, 250, 0, 0);
    background.addColorStop(0, "rgba(255,250,207,255)");
    ctx.fillStyle = background;
    ctx.fillRect(chartArea.left, chartArea.bottom,
      chartArea.right - chartArea.left, chartArea.top - chartArea.bottom);
  }
};
// add city/place name
  setTimeout(function writeText(){
    var c = document.getElementById("populationChart");
    var ctx = c.getContext("2d");
    ctx.font = "15px Roboto";
    ctx.textAlign = "left";
    ctx.fillStyle = "black";
    ctx.fillText([place], 55, 42);
    }, 1500);
// add year
  setTimeout(function writeText(){
    var c = document.getElementById("populationChart");
    var ctx = c.getContext("2d");
    ctx.font = "30px Roboto";
    ctx.textAlign = "center";
    ctx.fillStyle = "black";
    ctx.fillText([year], 270, 30);
    }, 1500);
// add total population
  setTimeout(function writeText(){
    var c = document.getElementById("populationChart");
    var ctx = c.getContext("2d");
    ctx.font = "15px Roboto";
    ctx.textAlign = "right";
    ctx.fillStyle = "black";
    ctx.fillText(["gesamt: ",'',[population]].join(''), 480, 42);
    }, 1500);
// add unit
  setTimeout(function writeText(){
    var c = document.getElementById("populationChart");
    var ctx = c.getContext("2d");
    ctx.font = "15px Roboto";
    ctx.textAlign = "right";
    ctx.fillStyle = "black";
    ctx.fillText(["in ",'',[unit]].join(''), 480, 447.5);
    }, 1500);
// add signature
  setTimeout(function writeText(){
    var c = document.getElementById("populationChart");
    var ctx = c.getContext("2d");
    ctx.font = "10px Roboto";
    ctx.textAlign = "center";
    ctx.fillStyle = "black";
    ctx.fillText("geographie-im-unterricht.de | Alexander Henkes", 250, 495);
    }, 1500);
    
// input values
  if (Chart.getChart(populationChart) === undefined) {
    let ctx = document.getElementById('populationChart').getContext('2d');
    populationChart = new Chart(ctx, {
      data: {
        labels: ['≥ 96', '91–95', '86–90', '81–85', '76–80', '71–75', '66–70', '61–65', '56–60', '51–55', '46–50', '41–45', '36–40', '31–35', '26–30', '21–25', '16–20', '11–15', '6–10', '≤ 5'],
        datasets: [{
          label: 'male',
          data: [male20, male19, male18, male17, male16, male15, male14, male13, male12, male11, male10, male9, male8, male7, male6, male5, male4, male3, male2, male1],
          backgroundColor: 'rgba(170,201,219,255)',
          borderColor: 'rgba(138,133,143,255)',
          barPercentage: 1.0,
          categoryPercentage: 1.07,
          borderWidth: 2,
        },{
          label: 'female',
          data: [female20, female19, female18, female17, female16, female15, female14, female13, female12, female11, female10, female9, female8, female7, female6, female5, female4, female3, female2, female1],
          backgroundColor: 'rgba(222,168,194,255)',
          borderColor: 'rgba(138,133,143,255)',
          barPercentage: 1.0,
          categoryPercentage: 1.07,
          borderWidth: 2,
        }]
      },
        
// config
    plugins: [whitebackgroundColor, backgroundColor],
    type: 'bar',
    options: {
      events: [],
      indexAxis: 'y',
    plugins: {
       legend: {
        display: false,
      }
    },
    aspectRatio: 1,
    layout: {
      padding: {
      top: 50,
      bottom: 20,
      }
    },
      scales: {
        x: {
            grid: {
            color: (ctx) => {
                const zeroLine = ctx.tick.value;
                const notzeroLine = ctx.tick.value;
                const gridColor = zeroLine === 0 ? '#666' : '#ccc' ;
                const gridColor2 = notzeroLine > -1000 ? '#666' : '#ccc' ;
                return gridColor, gridColor2;
                }
            }, 
         min: (maxMaleRounded * -1),
          max: maxFemaleRounded,
          stacked: true,
          ticks: {
              //stepSize: 5,
              callback: function(value, index, values) {
                return Math.abs(value);
                }
            }
        },
        y: {
          beginAtZero: true,
          stacked: true,
          }
      }
    },
 });
      
  } else {
    populationChart.destroy();
    create_populationChart();
  }
};
    
// create download
function download(){
    setTimeout(function() {
    const imageLink = document.createElement('a');
    const canvas = document.getElementById('populationChart');
    imageLink.download = 'bevoelkerungsdiagramm.png';
    imageLink.href = canvas.toDataURL('image/png', 1);
    // document.write('<img src=" '+imageLink+' "/>');
    imageLink.click();
    }, 500);
}

</script>
  </body>
    </html>